# 13 重み付きグラフ

- 最小全域木(MST)にはプリム法 (名前がかわいい).  `O(|V|^2)`.
- (Advanceで触れるため脱線) クラスカル法: プリム法に優先度付きキューを導入したもの。 `O( |E| * log|V| )` でMSTが求まる。
- 単一始点最短経路(SSSP)にはダイクストラ法。 `O(|V|^2)`。
- ダイクストラ法は優先度付きキューを使って実装することで  `O( (|E| + |V|) * log|V| )` で計算できる。
- ダイクストラ法は負の重みを持つグラフには使えない。(その場合はベルマン・フォード法かワーシャル・フロイド法がよいらしい)
 
> この章の問題を解くためには、グラフのデータ構造を実装することができるプログラミングスキルが必要です。また、より効率のよいアルゴリズムを実装するために、優先度付きキューの知識とそれを応用するプログラミングスキルが必要です。

>重み付きグラフ
>グラフの辺に重み（コスト）が付いているグラフを、重み付きグラフ[英 10]と呼ぶ[9]。乗換案内図の場合、駅間の所要時間が「重み」にあたる。重み付きグラフはネットワークとも呼ばれる（フローネットワーク, ベイジアンネットワーク, ニューラルネットワークなど）。
>[グラフ理論 - Wikipedia](https://ja.wikipedia.org/wiki/グラフ理論)

「ネットワークとは、重み付きグラフのことである。」しっくりくるな。

## 13.1  問題にチャレンジする前に

### 全域木

> 復習になりますが、木とは閉路を持たないグラフです。

> グラフの全域木(Spanning Tree)とは、グラフのすべての頂点Vを含む部分グラフであって、木である限りできるだけ多くの辺を持つものを言います

(日本語でおｋ)。

> グラフの全域木は、BFSまたはDFSで求めることができますが、グラフの全域木は一つとは限りません。
> 最小全域木 (Minimum Spanning Tree)とは、、グラフの全域木の中で、変の重みの総和が最小のものを言います。

### 最短経路

> 重み付きグラフにおいて、ある与えられた頂点の組s,dを接続する経路の中で、辺の重みの総和が最小であるパスを求める問題です。この問題は、主に以下の２つに分類されます。

> 単一始点最短経路 (Single Source ShortestPath: SSSP). グラフGにおいて、与えられた一つの頂点 s から、他のすべての頂点d _i への最短経路を求める問題です。

> 全点対間最短経路(All Pairs Shortest Path: APSP) . グラフGにおいて、すべての頂点のペア感の最短経路を求める問題。

## 13.2 最小全域木

http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=ALDS1_12_A

最小全域木(MST)を求める代表的なアルゴリズムの一つがプリムのアルゴリズムです。プリムのアルゴリズムの基本的な考え方は以下のようになります。

> グラフ G=(V,E)の頂点全体の集合をV,MSTに属する頂点の集合をTとします。
> 1. Gから任意の頂点rを選び、それをMSTのルートとして、Tに追加します。
> 2. 次の処理をT=Vになるまで繰り返します。
> 　Tに属する頂点とV-Tに属する頂点をつなぐ辺の中で、重みが最小のものである辺(p_u, u)を選び、それをMSTの辺とし、uをTに追加します。

>プリムのアルゴリズムは、二分ヒープ(優先度付きキュー)を使って頂点を決定するようにすれば、高速化を行うことができます(クラスカル法)。この方法は、以降の最短経路問題に関する問題の解法に応用します。

## 13.3 単一始点最短経路 そのいち with Adjacency Matrix or List

http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=ALDS1_12_B

隣接行列,隣接リストによるダイクストラ法は、 `O(|V|^2)` の計算量。

> 単一始点最短経路 (Single Source ShortestPath: SSSP). グラフGにおいて、与えられた一つの頂点 s から、他のすべての頂点d _i への最短経路を求める問題です。

## 13.3 単一始点最短経路 そのに with Binary Heap (**Priority** Queue)

一方、優先度付きキューを使った場合、頂点 u を二分ヒープからとり出すために `O( |V| * log|V| )` , d[v]を更新するために `O( |E| * log|V| )` の計算が必要になるため、 `O( (|E| + |V|) * log|V| )` の計算量ですむ。

>ダイクストラ法は、隣接リストによる表現と、二分ヒープ(優先度付きキュー)を応用することによって、飛躍的に高速かすることができます。

http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=ALDS1_12_C